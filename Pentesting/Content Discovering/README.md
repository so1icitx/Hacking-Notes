
# Content Discovery - TryHackMe Lesson

This README serves as a guide for the "Content Discovery" lesson on TryHackMe. 

---

## What is Content in Web Security?

Content refers to any resource on a website—files, videos, pictures, backups, or features like admin portals. In content discovery, we’re not interested in obvious elements (e.g., the homepage); we’re after hidden or restricted items not meant for public access. Examples include:

- Staff-only pages or portals.
- Old website versions.
- Backup files (e.g., `backup.zip`).
- Configuration files (e.g., `config.php`).
- Administration panels.

Discovering such content can reveal vulnerabilities or sensitive information.

---

## Three Methods of Content Discovery

There are three primary approaches to finding hidden content:

1. **Manual Discovery**: Checking specific locations by hand.
2. **Automated Discovery**: Using tools to scan for files and directories.
3. **OSINT (Open-Source Intelligence)**: Leveraging freely available external resources.

---

## Manual Discovery Techniques

Manual discovery involves exploring a website without automation, focusing on common locations where hidden content might reside.

### 1. Robots.txt
- **What is it?**: A file (`/robots.txt`) that instructs search engine crawlers which pages or directories to index or ignore.
- **Why check it?**: Website owners often block sensitive areas (e.g., `/admin`, `/private`) from search engines, making it a treasure map for testers.
- **Example**: 
  ```
  User-agent: *
  Disallow: /admin/
  Disallow: /backups/
  ```
  - Visit `http://example.com/admin/` or `http://example.com/backups/` to see what’s hidden.

### 2. Favicon
- **What is it?**: A small icon (`favicon.ico`) in the browser tab, often tied to a website’s branding.
- **Why check it?**: Default favicons from frameworks (e.g., WordPress) can reveal the tech stack if not customized.
- **How to use it?**: Compare the favicon’s hash or design to the [OWASP Favicon Database](https://wiki.owasp.org/index.php/OWASP_favicon_database).
- **Example**: A WordPress favicon might hint at exploitable plugins or versions.

### 3. Sitemap.xml
- **What is it?**: A file (`/sitemap.xml`) listing pages the owner wants search engines to index.
- **Why check it?**: It may include obscure or outdated pages not linked on the site.
- **Example**:
  ```xml
  <url><loc>http://example.com/old-page/</loc></url>
  ```
  - Visit `http://example.com/old-page/` to check if it’s still active.

### 4. HTTP Headers
- **What are they?**: Metadata returned by the web server with each response.
- **Why check them?**: They can reveal software versions (e.g., Apache, PHP), which might be vulnerable.
- **How to check?**: Use `curl` with verbose mode:
  ```bash
  curl -v http://example.com
  ```
- **Example Output**:
  ```
  Server: nginx/1.18.0
  X-Powered-By: PHP/7.4.3
  ```
  - Research vulnerabilities in Nginx 1.18.0 or PHP 7.4.3.

### 5. Framework Stack
- **What is it?**: The technology stack (e.g., Django, WordPress) used to build the site.
- **Why check it?**: Clues in page source (comments, credits) or favicons can identify the framework, leading to known vulnerabilities or default paths (e.g., `/wp-admin` for WordPress).
- **How to use it?**: Visit the framework’s official site for documentation or default file structures.

---

## OSINT (Open-Source Intelligence) Techniques

OSINT uses freely available tools and data to uncover content beyond the website itself.

### 1. Google Hacking / Dorking
- **What is it?**: Advanced Google searches using filters to find specific content.
- **How to use it?**:
  - `site:example.com`: Limit results to a domain.
  - `inurl:admin`: Find URLs with “admin”.
  - `filetype:pdf`: Find specific file types.
  - `intitle:login`: Find pages with “login” in the title.
- **Example**: `site:tryhackme.com inurl:admin`—searches for admin pages on TryHackMe.
- **Learn More**: [Wikipedia: Google Hacking](https://en.wikipedia.org/wiki/Google_hacking).

### 2. Wappalyzer
- **What is it?**: A tool ([wappalyzer.com](https://www.wappalyzer.com/)) and browser extension identifying website technologies.
- **Why use it?**: Detects frameworks, CMS (e.g., WordPress), and version numbers.
- **Example**: Reveals a site uses Drupal 8.9.0—check for known exploits.

### 3. Wayback Machine
- **What is it?**: An archive of website snapshots ([archive.org/web/](https://archive.org/web/)).
- **Why use it?**: Find old pages or files still active on the current site.
- **Example**: Search `example.com`—discover an old `/backup/` directory from 2018.

### 4. GitHub
- **What is it?**: A platform for hosting Git repositories, sometimes containing sensitive data.
- **Why use it?**: Public repos might leak source code, passwords, or API keys.
- **How to use it?**: Search for the target’s company name or domain (e.g., “example.com”).
- **Example**: Find `example.com-config` with a hardcoded admin password.

### 5. S3 Buckets
- **What are they?**: Amazon AWS storage (e.g., `http://name.s3.amazonaws.com`).
- **Why check them?**: Misconfigured permissions can expose files.
- **How to find them?**: Look in page source, GitHub, or guess names like `example-assets`, `example-public`.
- **Example**: `http://tryhackme-assets.s3.amazonaws.com`—test for public access.

---

## Automated Discovery

### What is Automated Discovery?
Automated discovery uses tools to send thousands or millions of requests to a web server, checking for the existence of files and directories. It’s faster than manual methods and relies on **wordlists**.

### What are Wordlists?
Wordlists are text files with lists of common words tailored to specific purposes:
- **Password wordlists**: e.g., `rockyou.txt` for brute-forcing.
- **Content discovery wordlists**: e.g., `directory-list-2.3-medium.txt` for file/directory names.
- **Where to find them?**: Tools like `dirb`, `gobuster`, or SecLists (`/usr/share/wordlists/SecLists/`).

### Tools for Automated Discovery
1. **Gobuster**:
   - **Purpose**: Enumerates directories and files.
   - **Command**:
     ```bash
     gobuster dir -u http://example.com -w /path/to/wordlist.txt -x .php,.txt
     ```
   - **Flags**:
     - `-u`: Target URL.
     - `-w`: Wordlist.
     - `-x`: File extensions to check.
   - **Example Output**:
     ```
     /admin (Status: 301)
     /backup.php (Status: 200)
     ```

2. **Dirb**:
   - **Purpose**: Similar to Gobuster, brute-forces directories.
   - **Command**:
     ```bash
     dirb http://example.com /path/to/wordlist.txt
     ```

3. **Wfuzz**:
   - **Purpose**: Fuzzes URLs with custom payloads.
   - **Command**:
     ```bash
     wfuzz -u http://example.com/FUZZ -w /path/to/wordlist.txt
     ```

---

## Practical Example
- **Target**: `http://example.com`
- **Manual**:
  - Check `/robots.txt`: Find `/admin`.
  - Visit `/admin`—discover a login page.
- **OSINT**:
  - Google Dork: `site:example.com filetype:pdf`—find `backup.pdf`.
  - Wayback Machine: Uncover `/old-site/index.html`.
- **Automated**:
  - Run `gobuster dir -u http://example.com -w directory-list-2.3-medium.txt -x .php`:
    ```
    /config.php (Status: 200)
    /backups (Status: 301)
    ```

---

## Key Takeaways
- **Manual**: Quick for obvious spots like `robots.txt` or headers.
- **OSINT**: Expands scope using external data.
- **Automated**: Scales discovery with wordlists and tools.
- **Why it matters**: Hidden content often leads to vulnerabilities or sensitive data leaks.

---

## Additional Resources
- [SecLists](https://github.com/danielmiessler/SecLists): Wordlists for all purposes.
- [GTFOBins](https://gtfobins.github.io/): For post-exploitation (if you gain access).
- [OWASP Web Security Testing Guide](https://owasp.org/www-project-web-security-testing-guide/): Deeper dive into testing.

